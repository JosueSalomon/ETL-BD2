CREATE OR REPLACE PROCEDURE ETL_EVENTOS AS
    V_FECHA_INICIO DATE;
    V_FECHA_FIN DATE := TRUNC(SYSDATE); -- Fecha actual
    V_HORA_INICIO_PROCESO DATE := SYSDATE;
BEGIN
        EXECUTE IMMEDIATE 'TRUNCATE TABLE C##DWH.TBL_EVENTOS';

    SELECT MIN(FECHA_INICIO) INTO V_FECHA_INICIO FROM TBL_EVENTOS_GOOGLE_DRIVE;

    IF V_FECHA_INICIO IS NULL THEN
        DBMS_OUTPUT.PUT_LINE('No hay datos para procesar.');
        RETURN;
    END IF;
    
    WHILE V_FECHA_INICIO <= V_FECHA_FIN LOOP
    
    DELETE FROM C##DWH.TBL_EVENTOS
    WHERE TRUNC(FECHA_INICIO) = TRUNC(V_FECHA_INICIO);
    
    INSERT INTO C##DWH.TBL_EVENTOS(
        ID_EVENTO,
        ID_ARCHIVO,
        ID_USAURIO,
        TITULO,
        DESCRIPCION,
        FECHA_INICIO,
        FECHA_FIN
    )
    SELECT ID_EVENTO,ID_ARCHIVO,ID_USUARIO,TITULO
    ,DESCRIPCION,FECHA_INICIO,FECHA_FIN
    FROM TBL_EVENTOS_GOOGLE_DRIVE
    WHERE TRUNC(FECHA_INICIO) = TRUNC(V_FECHA_INICIO);
        COMMIT;
        
        -- Incrementar la fecha
        V_FECHA_INICIO := V_FECHA_INICIO + 1;
    END LOOP;

END ETL_EVENTOS;

BEGIN
    ETL_EVENTOS;
END;

select * from TBL_EVENTOS_GOOGLE_DRIVE;