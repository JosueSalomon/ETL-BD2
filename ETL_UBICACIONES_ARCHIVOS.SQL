CREATE OR REPLACE PROCEDURE ETL_UBICACIONES_ARCHIVOS AS
BEGIN
    -- Truncar la tabla de destino
    EXECUTE IMMEDIATE 'TRUNCATE TABLE C##DWH.TBL_UBICACIONES_ARCHIVOS';

    -- Insertar registros desde la tabla de origen a la tabla de destino
    INSERT INTO C##DWH.TBL_UBICACIONES_ARCHIVOS(
        ID_UBICACION,
        ID_UBICACION_PADRE
    )
    SELECT ID_UBICACION,
           ID_UBICACION_PADRE
    FROM TBL_UBICACIONES_ARCHIVOS;

    COMMIT;
END ETL_UBICACIONES_ARCHIVOS;

BEGIN
ETL_UBICACIONES_ARCHIVOS;
END;